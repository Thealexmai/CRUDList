<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>CRUDList</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Defensive coding in case bootstrap server is down -->
<link rel="stylesheet" href="css/bootstrap-theme.css">
<link rel="stylesheet" href="css/boostrap-theme.min.css">
<link rel="stylesheet" href="css/bootstrap.css">
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet"
	href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

<script src="js/boostrap.js"></script>
<script src="js/boostrap.min.js"></script>

<!-- Get from online -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script
	src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Run Javascript -->
<script type="text/javascript">
	//function that logs you in
	$(document).ready(function() {
		$("#loginsubmit").click(function() {
			var emailToLookup = $("#loginemail").val();
			var passwordToLookup = $("#loginpassword").val();
			// console.log(emailToLookup);
			$.ajax({
				url : "/cgi-bin/login.py",
				data : {
					loginemail : emailToLookup,
					loginpassword : passwordToLookup
				},
				type : "POST",
				dataType : "json",
				success : function(data) {
					console.log(data);
					//Hide the registration material
					$(".form-group").hide();
					// Create a cookie if successfully logged in
					setCookie(data.email, data.firstname, 7);
					
					$("#loggedname").html(
							"Welcome Back " + data.firstname
									+ " " + data.lastname);
				},
				// Code to run if the request fails
				error : function() {
					alert("Sorry, there was a problem!");
				},
			});
		});
	});
</script>

<script type="text/javascript">
	// Function that sets the cookie
	function setCookie(key, value, expdays) {
		var d = new Date();
		d.setTime(d.getTime() + (expdays*24*60*60*1000));
		var expires = "expires="+d.toUTCString();
		document.cookie = key + "=" + value + ";" + expires;
	}
</script>
</head>

<body>
	<div class="container">
		<header>
			<h1>CRUDList</h1>
		</header>

		<!-- I am a: -->
		<!-- 	<ul class="nav nav-tabs">
		<li class="active"><a data-toggle="tab" href="#register">Register</a></li>
		 <li><a data-toggle="tab" href="#login">Login</a></li>
	</ul>  -->

		<!-- For the buyer -->
		<div>
			<!-- Buyer's submission -->
			<form action="cgi-bin/insert.py">
				<div class="form-group">
					<label for="name">First Name</label> <input type="text"
						id="firstname" name="firstname" class="form-control"
						placeholder="First name">
				</div>
				<div class="form-group">
					<label for="name">Last Name</label> <input type="text"
						id="lastname" name="lastname" class="form-control"
						placeholder="Last name">
				</div>
				<div class="form-group">
					<label for="email">Email address</label> <input type="email"
						name="email" id="email" class="form-control"
						placeholder="@u.rochester.edu">
				</div>
				<div class="form-group">
					<label for="password">Password</label> <input type="password"
						name="password" id="password" class="form-control"
						placeholder="Password">
				</div>
				<div class="form-group">
					<label for="services">Services</label> <input type="text"
						name="services" id="services" class="form-control"
						placeholder="List services">
				</div>
				<div class="form-group">
					<label for="description">Tell me about yourself</label>
					<textarea id="description" name="description" class="form-control"
						rows="5" placeholder="Describe what you're looking for"></textarea>
				</div>
				<button type="submit" id="submit" name="submit"
					class="btn btn-default form-group">Submit</button>
			</form>

			<!-- Button for register -->
		</div>
		<!-- end of register tab-->

		<!-- For the log in -->
		<div class="form-group">
			<label for="loginemail">Email</label> <input type="text"
				id="loginemail" name="loginemail" class="form-control"
				placeholder="@u.rochester.edu">
		</div>
		<div class="form-group">
			<label for="loginpassword">Password</label> <input type="text"
				id="loginpassword" name="loginpassword" class="form-control"
				placeholder="Password">
		</div>
		<button type="submit" id="loginsubmit"
			class="btn btn-default form-group">Log in</button>
		<!-- End of login -->

		<!-- Empy placeholders for succesful log in -->
		<div id="loggedname"></div>


	</div>
	<!-- End of container -->
</body>
</html>
